<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MelodAI System Status</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        background-color: #f5f5f5;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      }
      .status-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
      .status-card {
        margin-bottom: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s;
      }
      .status-card:hover {
        transform: translateY(-5px);
      }
      .status-card-header {
        padding: 15px;
        border-radius: 8px 8px 0 0;
        font-weight: bold;
      }
      .status-OK {
        background-color: #d4edda;
        border-color: #c3e6cb;
        color: #155724;
      }
      .status-WARNING {
        background-color: #fff3cd;
        border-color: #ffeeba;
        color: #856404;
      }
      .status-ERROR {
        background-color: #f8d7da;
        border-color: #f5c6cb;
        color: #721c24;
      }
      .status-UNKNOWN {
        background-color: #e2e3e5;
        border-color: #d6d8db;
        color: #383d41;
      }
      .timestamp {
        font-size: 0.8rem;
        color: #6c757d;
      }
      .nav-tabs {
        margin-bottom: 20px;
      }
      #refreshBtn {
        margin-left: 10px;
      }
      .spinner-border {
        width: 1rem;
        height: 1rem;
        margin-right: 5px;
      }
      .component-filter {
        margin-bottom: 20px;
      }
      .queue-item {
        margin-bottom: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        padding: 15px;
        background-color: white;
        border-left: 5px solid #007bff;
        transition: all 0.2s;
      }
      .queue-item:hover {
        transform: translateX(5px);
      }
      .queue-item-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
      }
      .queue-item-title {
        font-weight: bold;
        font-size: 1.1rem;
        margin: 0;
      }
      .queue-item-artist {
        color: #6c757d;
        margin: 0;
      }
      .queue-item-status {
        padding: 3px 8px;
        border-radius: 12px;
        font-size: 0.8rem;
        font-weight: 500;
      }
      .status-downloading,
      .status-splitting,
      .status-extracting_lyrics {
        background-color: #cce5ff;
        color: #004085;
      }
      .status-downloaded,
      .status-split_complete,
      .status-raw_lyrics_complete {
        background-color: #d4edda;
        color: #155724;
      }
      .status-error,
      .status-download_error,
      .status-split_error {
        background-color: #f8d7da;
        color: #721c24;
      }
      .progress {
        height: 8px;
        margin-top: 10px;
      }
      .empty-queue-message {
        text-align: center;
        padding: 50px;
        color: #6c757d;
      }
      .queue-info {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 15px;
      }
      .queue-count {
        font-size: 1.1rem;
        font-weight: 500;
      }
      .elapsed-time {
        font-size: 0.9rem;
        color: #6c757d;
      }
      .unfinished-songs-table {
        width: 100%;
        margin-top: 20px;
      }
      .unfinished-song-row {
        transition: background-color 0.2s;
      }
      .unfinished-song-row:hover {
        background-color: #f8f9fa;
      }
      .reprocess-btn {
        background-color: #17a2b8;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.2s;
      }
      .reprocess-btn:hover {
        background-color: #138496;
      }
      .reprocess-btn:disabled {
        background-color: #6c757d;
        cursor: not-allowed;
      }
      .unfinished-info {
        margin-bottom: 15px;
        color: #6c757d;
      }
      .completion-badge {
        display: inline-block;
        width: 60px;
        text-align: center;
        padding: 2px 6px;
        border-radius: 12px;
        font-size: 0.8rem;
        font-weight: 500;
      }
      .completion-low {
        background-color: #f8d7da;
        color: #721c24;
      }
      .completion-medium {
        background-color: #fff3cd;
        color: #856404;
      }
      .completion-high {
        background-color: #d4edda;
        color: #155724;
      }
      .missing-items {
        font-size: 0.85rem;
        color: #6c757d;
        margin-top: 3px;
      }
      .toast-container {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1050;
      }
      .toast {
        background-color: white;
        border-radius: 4px;
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
        margin-bottom: 10px;
        width: 350px;
        max-width: 100%;
      }
      .toast-header {
        display: flex;
        align-items: center;
        padding: 0.5rem;
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
      }
      .toast-body {
        padding: 0.75rem;
      }
      .toast-success .toast-header {
        background-color: #d4edda;
        color: #155724;
      }
      .toast-error .toast-header {
        background-color: #f8d7da;
        color: #721c24;
      }
    </style>
  </head>
  <body>
    <div class="status-container">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>MelodAI System Status</h1>
        <div>
          <a href="/admin" class="btn btn-outline-secondary">Back to Admin</a>
          <button id="refreshBtn" class="btn btn-primary">
            <span
              id="refreshSpinner"
              class="spinner-border d-none"
              role="status"
            ></span>
            Refresh Status
          </button>
        </div>
      </div>

      <ul class="nav nav-tabs" id="statusTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button
            class="nav-link active"
            id="current-tab"
            data-bs-toggle="tab"
            data-bs-target="#current"
            type="button"
            role="tab"
            aria-controls="current"
            aria-selected="true"
          >
            Current Status
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="queue-tab"
            data-bs-toggle="tab"
            data-bs-target="#queue"
            type="button"
            role="tab"
            aria-controls="queue"
            aria-selected="false"
          >
            Processing Queue
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="unfinished-tab"
            data-bs-toggle="tab"
            data-bs-target="#unfinished"
            type="button"
            role="tab"
            aria-controls="unfinished"
            aria-selected="false"
          >
            Unfinished Tracks
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="history-tab"
            data-bs-toggle="tab"
            data-bs-target="#history"
            type="button"
            role="tab"
            aria-controls="history"
            aria-selected="false"
          >
            Status History
          </button>
        </li>
      </ul>

      <div class="tab-content" id="statusTabContent">
        <!-- Current Status Tab -->
        <div
          class="tab-pane fade show active"
          id="current"
          role="tabpanel"
          aria-labelledby="current-tab"
        >
          <div class="alert alert-info" role="alert">
            Last updated: <span id="lastUpdated">Never</span>
          </div>
          <div id="currentStatus">
            <div class="d-flex justify-content-center my-5">
              <div
                class="spinner-border text-primary"
                role="status"
                style="width: 3rem; height: 3rem"
              >
                <span class="visually-hidden">Loading...</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Processing Queue Tab -->
        <div
          class="tab-pane fade"
          id="queue"
          role="tabpanel"
          aria-labelledby="queue-tab"
        >
          <div class="alert alert-info" role="alert">
            Queue last updated: <span id="queueLastUpdated">Never</span>
          </div>
          <div class="queue-info">
            <div class="queue-count" id="queueCount">0 tracks in queue</div>
            <button id="refreshQueueBtn" class="btn btn-sm btn-outline-primary">
              <span
                id="refreshQueueSpinner"
                class="spinner-border d-none"
                role="status"
              ></span>
              Refresh Queue
            </button>
          </div>
          <div id="processingQueue">
            <div class="d-flex justify-content-center my-5">
              <div
                class="spinner-border text-primary"
                role="status"
                style="width: 3rem; height: 3rem"
              >
                <span class="visually-hidden">Loading...</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Unfinished Songs Tab -->
        <div
          class="tab-pane fade"
          id="unfinished"
          role="tabpanel"
          aria-labelledby="unfinished-tab"
        >
          <div class="alert alert-info" role="alert">
            Unfinished tracks last updated:
            <span id="unfinishedLastUpdated">Never</span>
          </div>
          <div class="d-flex justify-content-between align-items-center">
            <div class="unfinished-info" id="unfinishedCount">
              Loading unfinished tracks...
            </div>
            <button
              id="refreshUnfinishedBtn"
              class="btn btn-sm btn-outline-primary"
            >
              <span
                id="refreshUnfinishedSpinner"
                class="spinner-border d-none"
                role="status"
              ></span>
              Refresh List
            </button>
          </div>
          <div id="unfinishedSongs">
            <div class="d-flex justify-content-center my-5">
              <div
                class="spinner-border text-primary"
                role="status"
                style="width: 3rem; height: 3rem"
              >
                <span class="visually-hidden">Loading...</span>
              </div>
            </div>
          </div>
        </div>

        <!-- History Tab -->
        <div
          class="tab-pane fade"
          id="history"
          role="tabpanel"
          aria-labelledby="history-tab"
        >
          <div class="component-filter mb-3">
            <label for="componentFilter" class="form-label"
              >Filter by component:</label
            >
            <select id="componentFilter" class="form-select">
              <option value="">All Components</option>
            </select>
          </div>
          <div id="historyTable">
            <div class="d-flex justify-content-center my-5">
              <div
                class="spinner-border text-primary"
                role="status"
                style="width: 3rem; height: 3rem"
              >
                <span class="visually-hidden">Loading...</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast container for notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        // Load initial data
        fetchCurrentStatus()

        // Set up event listeners
        document
          .getElementById('refreshBtn')
          .addEventListener('click', fetchCurrentStatus)
        document
          .getElementById('queue-tab')
          .addEventListener('click', fetchProcessingQueue)
        document
          .getElementById('refreshQueueBtn')
          .addEventListener('click', fetchProcessingQueue)
        document
          .getElementById('unfinished-tab')
          .addEventListener('click', fetchUnfinishedSongs)
        document
          .getElementById('refreshUnfinishedBtn')
          .addEventListener('click', fetchUnfinishedSongs)
        document
          .getElementById('history-tab')
          .addEventListener('click', fetchStatusHistory)
        document
          .getElementById('componentFilter')
          .addEventListener('change', function () {
            fetchStatusHistory(this.value)
          })

        // Set up socket.io event listeners for reprocessing
        if (typeof io !== 'undefined') {
          const socket = io()
          socket.on('track_reprocessed', function (data) {
            if (data.success) {
              showToast(
                'Success',
                `Track ${data.track_id} was reprocessed successfully!`,
                'success'
              )
            } else {
              showToast(
                'Error',
                `Failed to reprocess track ${data.track_id}: ${data.error}`,
                'error'
              )
            }
            // Refresh the list after a slight delay
            setTimeout(fetchUnfinishedSongs, 2000)
          })
        }

        // Set up auto-refresh for queue
        setInterval(function () {
          // Only refresh if the queue tab is visible
          if (document.getElementById('queue').classList.contains('active')) {
            fetchProcessingQueue(false) // silent refresh (no spinners)
          }
        }, 5000) // refresh every 5 seconds
      })

      function fetchCurrentStatus() {
        // Show loading spinner
        const refreshBtn = document.getElementById('refreshBtn')
        const refreshSpinner = document.getElementById('refreshSpinner')
        refreshBtn.disabled = true
        refreshSpinner.classList.remove('d-none')

        // Add timestamp to prevent caching
        const timestamp = new Date().getTime()

        fetch(`/admin/status/check?timestamp=${timestamp}`)
          .then((response) => response.json())
          .then((data) => {
            displayCurrentStatus(data.checks)
            document.getElementById('lastUpdated').textContent =
              new Date().toLocaleString()
          })
          .catch((error) => {
            console.error('Error fetching status:', error)
            document.getElementById('currentStatus').innerHTML = `
                        <div class="alert alert-danger">
                            Error fetching status: ${error.message}
                        </div>
                    `
          })
          .finally(() => {
            // Hide loading spinner
            refreshBtn.disabled = false
            refreshSpinner.classList.add('d-none')
          })
      }

      function fetchProcessingQueue(showSpinner = true) {
        // Show loading spinner if required
        if (showSpinner) {
          const refreshBtn = document.getElementById('refreshQueueBtn')
          const refreshSpinner = document.getElementById('refreshQueueSpinner')
          if (refreshBtn && refreshSpinner) {
            refreshBtn.disabled = true
            refreshSpinner.classList.remove('d-none')
          }
        }

        // Add timestamp to prevent caching
        const timestamp = new Date().getTime()

        fetch(`/admin/status/queue?timestamp=${timestamp}`)
          .then((response) => response.json())
          .then((data) => {
            displayProcessingQueue(data.queue)
            document.getElementById('queueLastUpdated').textContent =
              new Date().toLocaleString()

            // Update queue count
            document.getElementById('queueCount').textContent = `${
              data.queue.length
            } track${data.queue.length !== 1 ? 's' : ''} in queue`
          })
          .catch((error) => {
            console.error('Error fetching queue:', error)
            document.getElementById('processingQueue').innerHTML = `
                        <div class="alert alert-danger">
                            Error fetching processing queue: ${error.message}
                        </div>
                    `
          })
          .finally(() => {
            // Hide loading spinner if required
            if (showSpinner) {
              const refreshBtn = document.getElementById('refreshQueueBtn')
              const refreshSpinner = document.getElementById(
                'refreshQueueSpinner'
              )
              if (refreshBtn && refreshSpinner) {
                refreshBtn.disabled = false
                refreshSpinner.classList.add('d-none')
              }
            }
          })
      }

      function displayCurrentStatus(checks) {
        const statusContainer = document.getElementById('currentStatus')
        statusContainer.innerHTML = ''

        checks.forEach((check) => {
          const card = document.createElement('div')
          card.className = 'card status-card'

          const header = document.createElement('div')
          header.className = `card-header status-card-header status-${check.status}`
          header.textContent = check.component

          const body = document.createElement('div')
          body.className = 'card-body'
          body.innerHTML = `
                    <h5 class="card-title">Status: ${check.status}</h5>
                    <p class="card-text">${check.details}</p>
                `

          card.appendChild(header)
          card.appendChild(body)
          statusContainer.appendChild(card)
        })
      }

      function displayProcessingQueue(queue) {
        const queueContainer = document.getElementById('processingQueue')
        queueContainer.innerHTML = ''

        if (queue.length === 0) {
          queueContainer.innerHTML = `
            <div class="empty-queue-message">
              <h4>No tracks currently being processed</h4>
              <p>The processing queue is empty.</p>
            </div>
          `
          return
        }

        queue.forEach((item) => {
          const queueItem = document.createElement('div')
          queueItem.className = 'queue-item'

          // Style based on status
          if (item.status.includes('error')) {
            queueItem.style.borderLeftColor = '#dc3545'
          } else if (item.progress >= 50) {
            queueItem.style.borderLeftColor = '#28a745'
          }

          queueItem.innerHTML = `
            <div class="queue-item-header">
              <div>
                <h5 class="queue-item-title">${
                  item.title || 'Unknown Track'
                }</h5>
                <p class="queue-item-artist">${
                  item.artist || 'Unknown Artist'
                }</p>
              </div>
              <span class="queue-item-status status-${
                item.status
              }">${formatStatus(item.status)}</span>
            </div>
            <div>
              <div class="d-flex justify-content-between">
                <span>Track ID: ${item.track_id}</span>
                <span class="elapsed-time">Time elapsed: ${
                  item.elapsed_time
                }</span>
              </div>
              <div class="progress">
                <div class="progress-bar" role="progressbar" style="width: ${
                  item.progress
                }%" 
                     aria-valuenow="${
                       item.progress
                     }" aria-valuemin="0" aria-valuemax="100"></div>
              </div>
            </div>
          `

          queueContainer.appendChild(queueItem)
        })
      }

      function formatStatus(status) {
        // Convert snake_case to Title Case with spaces
        return status
          .split('_')
          .map((word) => word.charAt(0).toUpperCase() + word.slice(1))
          .join(' ')
      }

      function fetchStatusHistory(component = '') {
        const historyContainer = document.getElementById('historyTable')
        historyContainer.innerHTML = `
                <div class="d-flex justify-content-center my-5">
                    <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
            `

        let url = '/admin/status/history'
        if (component) {
          url += `?component=${encodeURIComponent(component)}`
        }

        fetch(url)
          .then((response) => response.json())
          .then((data) => {
            // Populate component filter if it's empty
            const componentFilter = document.getElementById('componentFilter')
            if (componentFilter.options.length <= 1) {
              data.components.forEach((component) => {
                const option = document.createElement('option')
                option.value = component
                option.textContent = component
                componentFilter.appendChild(option)
              })
            }

            displayStatusHistory(data.history)
          })
          .catch((error) => {
            console.error('Error fetching status history:', error)
            historyContainer.innerHTML = `
                        <div class="alert alert-danger">
                            Error fetching status history: ${error.message}
                        </div>
                    `
          })
      }

      function displayStatusHistory(history) {
        const historyContainer = document.getElementById('historyTable')

        if (history.length === 0) {
          historyContainer.innerHTML = `
                    <div class="alert alert-info">
                        No status history available.
                    </div>
                `
          return
        }

        const table = document.createElement('table')
        table.className = 'table table-striped table-hover'

        const thead = document.createElement('thead')
        thead.innerHTML = `
                <tr>
                    <th>Component</th>
                    <th>Status</th>
                    <th>Details</th>
                    <th>Checked By</th>
                    <th>Timestamp</th>
                </tr>
            `

        const tbody = document.createElement('tbody')

        history.forEach((item) => {
          const row = document.createElement('tr')

          const statusCell = document.createElement('td')
          statusCell.innerHTML = `<span class="badge rounded-pill status-${item.status}">${item.status}</span>`

          row.innerHTML = `
                    <td>${item.component}</td>
                    <td>${statusCell.innerHTML}</td>
                    <td>${item.details}</td>
                    <td>${item.checked_by || 'System'}</td>
                    <td>${new Date(item.last_checked).toLocaleString()}</td>
                `

          tbody.appendChild(row)
        })

        table.appendChild(thead)
        table.appendChild(tbody)
        historyContainer.innerHTML = ''
        historyContainer.appendChild(table)
      }

      function fetchUnfinishedSongs(showSpinner = true) {
        // Show loading spinner if required
        if (showSpinner) {
          const refreshBtn = document.getElementById('refreshUnfinishedBtn')
          const refreshSpinner = document.getElementById(
            'refreshUnfinishedSpinner'
          )
          if (refreshBtn && refreshSpinner) {
            refreshBtn.disabled = true
            refreshSpinner.classList.remove('d-none')
          }
        }

        // Add timestamp to prevent caching
        const timestamp = new Date().getTime()

        fetch(`/admin/status/unfinished?timestamp=${timestamp}`)
          .then((response) => response.json())
          .then((data) => {
            displayUnfinishedSongs(data.unfinished_songs)
            document.getElementById('unfinishedLastUpdated').textContent =
              new Date().toLocaleString()

            // Update unfinished count
            document.getElementById('unfinishedCount').textContent = `${
              data.unfinished_songs.length
            } unfinished track${
              data.unfinished_songs.length !== 1 ? 's' : ''
            } found`
          })
          .catch((error) => {
            console.error('Error fetching unfinished songs:', error)
            document.getElementById('unfinishedSongs').innerHTML = `
                        <div class="alert alert-danger">
                            Error fetching unfinished songs: ${error.message}
                        </div>
                    `
          })
          .finally(() => {
            // Hide loading spinner if required
            if (showSpinner) {
              const refreshBtn = document.getElementById('refreshUnfinishedBtn')
              const refreshSpinner = document.getElementById(
                'refreshUnfinishedSpinner'
              )
              if (refreshBtn && refreshSpinner) {
                refreshBtn.disabled = false
                refreshSpinner.classList.add('d-none')
              }
            }
          })
      }

      function displayUnfinishedSongs(unfinishedSongs) {
        const container = document.getElementById('unfinishedSongs')
        container.innerHTML = ''

        if (unfinishedSongs.length === 0) {
          container.innerHTML = `
            <div class="alert alert-success">
              <h4>No unfinished tracks found</h4>
              <p>All tracks have been processed successfully.</p>
            </div>
          `
          return
        }

        // Create table
        const table = document.createElement('table')
        table.className = 'table table-hover unfinished-songs-table'

        // Create table header
        const thead = document.createElement('thead')
        thead.innerHTML = `
          <tr>
            <th>Track</th>
            <th>Last Modified</th>
            <th>Completion</th>
            <th>Missing Components</th>
            <th>Actions</th>
          </tr>
        `
        table.appendChild(thead)

        // Create table body
        const tbody = document.createElement('tbody')

        unfinishedSongs.forEach((song) => {
          const row = document.createElement('tr')
          row.className = 'unfinished-song-row'
          row.setAttribute('data-track-id', song.track_id)

          // Get badge class based on completion status
          let badgeClass = 'completion-low'
          if (song.completion_status >= 75) {
            badgeClass = 'completion-high'
          } else if (song.completion_status >= 50) {
            badgeClass = 'completion-medium'
          }

          row.innerHTML = `
            <td>
              <strong>${song.title || 'Unknown'}</strong>
              <div>${song.artist || 'Unknown Artist'}</div>
              <small class="text-muted">ID: ${song.track_id}</small>
            </td>
            <td>${song.last_modified}</td>
            <td>
              <span class="completion-badge ${badgeClass}">
                ${Math.round(song.completion_status)}%
              </span>
            </td>
            <td>
              <div class="missing-items">
                ${song.missing_items.join(', ')}
              </div>
            </td>
            <td>
              <button class="reprocess-btn" onclick="reprocessTrack('${
                song.track_id
              }')">
                Reprocess
              </button>
            </td>
          `

          tbody.appendChild(row)
        })

        table.appendChild(tbody)
        container.appendChild(table)
      }

      function reprocessTrack(trackId) {
        // Find and disable the button for this track
        const rows = document.querySelectorAll(`tr[data-track-id="${trackId}"]`)
        rows.forEach((row) => {
          const button = row.querySelector('.reprocess-btn')
          if (button) {
            button.disabled = true
            button.textContent = 'Processing...'
          }
        })

        // Call the API to reprocess the track
        fetch('/admin/status/reprocess', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ track_id: trackId }),
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.success) {
              showToast(
                'Processing Started',
                `Track ${trackId} is now being reprocessed.`,
                'success'
              )
            } else {
              showToast(
                'Error',
                data.error || 'Failed to reprocess track',
                'error'
              )
              // Re-enable the button
              rows.forEach((row) => {
                const button = row.querySelector('.reprocess-btn')
                if (button) {
                  button.disabled = false
                  button.textContent = 'Reprocess'
                }
              })
            }
          })
          .catch((error) => {
            console.error('Error reprocessing track:', error)
            showToast(
              'Error',
              'Failed to reprocess track: ' + error.message,
              'error'
            )
            // Re-enable the button
            rows.forEach((row) => {
              const button = row.querySelector('.reprocess-btn')
              if (button) {
                button.disabled = false
                button.textContent = 'Reprocess'
              }
            })
          })
      }

      function showToast(title, message, type) {
        const container = document.getElementById('toastContainer')

        const toast = document.createElement('div')
        toast.className = `toast toast-${type} show`
        toast.innerHTML = `
          <div class="toast-header">
            <strong class="me-auto">${title}</strong>
            <button type="button" class="btn-close" onclick="this.parentElement.parentElement.remove()"></button>
          </div>
          <div class="toast-body">
            ${message}
          </div>
        `

        container.appendChild(toast)

        // Auto-remove after 5 seconds
        setTimeout(() => {
          toast.remove()
        }, 5000)
      }
    </script>
  </body>
</html>
